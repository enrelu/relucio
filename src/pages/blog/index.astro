---
import Layout from '../../layouts/Layout.astro';
import Section from '../../components/Section.astro';
import BlogRow from '../../components/BlogRow.astro';
import { getCollection } from 'astro:content';

// 1. Obtener todos los posts de la colección 'blog'
const posts = (await getCollection('blog')).sort(
	(a, b) => b.data.pubDate.valueOf() - a.data.pubDate.valueOf()
);

// Título de la página
const title = "Blog - Enrique Relucio";
const description = "Artículos sobre ciberseguridad, estrategia y tecnología.";
---

<Layout title={title} description={description}>
	<main class="max-w-2xl mx-auto px-6 py-24 md:py-32 flex flex-col gap-16">
		
		<header class="flex flex-col gap-4">
			<a href="/" class="text-sm text-zinc-500 hover:text-zinc-900 dark:hover:text-zinc-200 transition-colors w-fit">
				← Volver al inicio
			</a>
			
			<div class="flex flex-col gap-2 mt-4">
				<h1 class="text-3xl font-medium tracking-tight text-zinc-900 dark:text-zinc-50">
					Escritura
				</h1>
				<p class="text-[16px] text-zinc-600 dark:text-zinc-400 leading-relaxed max-w-lg">
					Reflexiones sobre ingeniería, gestión de riesgos y el panorama actual de la ciberseguridad.
				</p>
			</div>
		</header>

		<section class="flex flex-col">
			{posts.length > 0 ? (
				posts.map((post) => (
					<BlogRow 
						title={post.data.title}
						date={post.data.pubDate}
						url={`/blog/${post.slug}/`}
						category={post.data.category} 
						tags={post.data.tags} 
						image={post.data.heroImage}     
					/>
				))
			) : (
				<div class="py-10 text-center border border-dashed border-zinc-200 dark:border-zinc-800 rounded-lg">
					<p class="text-zinc-500 text-sm">No hay artículos publicados todavía.</p>
				</div>
			)}
		</section>

	</main>
</Layout>