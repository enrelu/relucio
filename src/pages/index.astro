---
// 1. IMPORTACIONES
import Layout from '../layouts/Layout.astro';
import Section from '../components/Section.astro';
import ExpandableItem from '../components/ExpandableItem.astro';
import BlogRow from '../components/BlogRow.astro';
import Newsletter from '../components/Newsletter.astro';
import { getCollection } from 'astro:content';

// 2. DATOS DE PROYECTOS Y EXPERIENCIA
// PROYECTOS (Añadido campo 'details' con texto extendido)
const projects = [
  {
  id: "proj-1",
  title: "EmotionScore: Algoritmo de Calidad Deportiva (LLES)",
  category: "desarrollo",
  client: "Proyecto Personal",
  summary: "Desarrollo de un modelo matemático predictivo para calificar la 'espectacularidad' deportiva sin spoilers.",
  details: `Diseño y desarrollo integral de una plataforma que resuelve la "Paradoja del Spoiler" mediante el procesamiento de métricas avanzadas. El sistema ingesta datos de La Liga y aplica un algoritmo propio (LLES) para puntuar partidos del 0 al 5 basándose en la narrativa del juego y no solo en el resultado.

  Arquitectura y Desafíos Técnicos:
  - Ingeniería de Datos (ETL): Pipeline en Python (Pandas/Numpy) con extracción asíncrona (asyncio/aiohttp) de múltiples fuentes de datos (Understat, StatsBomb).
  - Modelado Matemático: Creación de un algoritmo multifactorial que pondera Goles Esperados (xG), Volatilidad de Victoria (WPA) e Índices de Caos para calcular la "Tensión Competitiva".
  - Full Stack: Backend ligero en FastAPI y Frontend en React diseñado con "Modo Ciego" para ocultar el marcador final.

  Impacto:
  - Innovación: Creación de métricas propias (IAO - Índice de Amenaza Ofensiva) normalizadas contra datos históricos.
  - Escalabilidad: Arquitectura preparada para procesar temporadas históricas y generar recomendaciones automatizadas.`,
  year: "2026"
}, {
  id: "proj-2",
  title: "Rediseño relucio.es",
  category: "desarrollo",
  client: "Proyecto Personal",
  summary: "Desarrollo de una plataforma estática de alto rendimiento orientada a la conversión y branding profesional mediante arquitectura moderna.",
  details: `Rediseño y desarrollo integral de mi plataforma profesional, migrando de un CMS convencional a una arquitectura de componentes moderna. El objetivo principal fue optimizar la velocidad de carga (Core Web Vitals) y la experiencia de usuario (UX) para un perfil de ingeniería y desarrollo de negocio.

  Arquitectura y Desafíos Técnicos:
  - Framework Astro: Implementación de arquitectura de islas para minimizar el JavaScript enviado al cliente, logrando tiempos de carga instantáneos.
  - UI/UX con Tailwind CSS: Diseño minimalista con soporte nativo para modo oscuro y adaptabilidad total (Responsive Design) para evitar solapamientos en dispositivos móviles.
  - Integración de Microservicios:
      * Pipeline de Datos: Conexión mediante RSS Parser para la ingesta dinámica de contenidos desde Substack, permitiendo la promoción cruzada de la newsletter "Ciberseguridad Táctica".
      * Componentes Reactivos: Desarrollo de widgets inteligentes con Intersection Observer para animaciones de estadísticas y elementos flotantes condicionados al scroll del usuario.
  - Despliegue & CI/CD: Configuración de flujo de trabajo automatizado mediante GitHub Actions y despliegue continuo en la red Edge de Vercel con gestión avanzada de DNS en OVH.

  Impacto:
  - Rendimiento: Puntuación de 100/100 en Google Lighthouse para Performance, SEO y Mejores Prácticas.
  - Conversión: Implementación de un widget de suscripción optimizado que aumenta la visibilidad de la newsletter sin comprometer la lectura del contenido principal.
  - Escalabilidad: Sistema preparado para la creación de contenido mediante Markdown/MDX, facilitando la publicación de artículos técnicos de forma ágil.`,
  year: "2026"
},
  {
  id: "proj-3",
  title: "Gobierno del Dato & DLP",
  category: "consultoria",
  client: "Entidad Bancaria Tier-1",
  summary: "Implementación de arquitectura Data-Centric Security para cumplimiento DORA/GDPR.",
  details: `Despliegue de una estrategia de seguridad centrada en el dato para resolver riesgos críticos de fuga de información y cumplimiento normativo. Se sustituyó un modelo ineficiente por clasificación automática y políticas unificadas en Endpoint y Cloud.

  Resultados e Impacto:
  - Volumen de Negocio: Cierre de contrato de 350.000€ (Licencias + Servicios) con validación directa de CISO y DPO.
  - Eficiencia Operativa: Reducción del 85% de falsos positivos, eliminando fricción en la operativa bancaria.
  - Cumplimiento: Trazabilidad del 100% en documentación confidencial y superación de auditoría regulatoria sin hallazgos.`,
  year: "2025"
},
  {
  id: "proj-4",
  title: "Protección de Correo & Cultura de Seguridad",
  category: "consultoria",
  client: "Empresa Sector Energía",
  summary: "Estrategia de defensa híbrida (IA + Factor Humano) contra fraude CEO y Phishing.",
  details: `Implementación de respuesta crítica ante intentos de fraude BEC (Business Email Compromise). Diseño de una arquitectura de seguridad en capas: protección perimetral con IA y activación del usuario como "Human Firewall".

  Resultados e Impacto:
  - Transformación Cultural: Reducción del Click-Rate del 32% al 4% en 12 meses y aumento del reporte proactivo al SOC (80% de las alertas provienen ahora de usuarios).
  - Eficacia Técnica: 99.9% de bloqueo de amenazas antes del buzón mediante Secure Email Gateway (SEG).
  - Negocio: Cierre de contrato SaaS recurrente de 3 años para 2.500 licencias.`,
  year: "2025"
},
  {
  id: "proj-5",
  title: "Estrategia de Seguridad & vCISO",
  category: "consultoria",
  client: "Grupo Industrial Textil",
  summary: "Gobernanza unificada y obtención de ISO 27001 para grupo en expansión (M&A).",
  details: `Transformación integral de la postura de seguridad en un entorno descentralizado por crecimiento inorgánico. Asumí el rol de CISO Virtual (vCISO) para definir la hoja de ruta a 3 años (Plan Director), centralizar la gestión de riesgos y diseñar el SGSI.

  Resultados e Impacto:
  - Madurez NIST: Incremento del índice de ciber-resiliencia de 1.2 (Inicial) a 3.5 (Definido) en 18 meses.
  - Habilitador de Negocio: Obtención de la certificación ISO 27001, desbloqueando el acceso a nuevas licitaciones comerciales.
  - Eficiencia Financiera: Ahorro del 15% en costes operativos (OPEX) mediante la consolidación de proveedores duplicados.
  - Relación a Largo Plazo: Contrato de 3 años como "Trusted Advisor" exclusivo para inversiones tecnológicas.`,
  year: "2025"
}
];

// EXPERIENCIA (Añadido campo 'details')
const experience = [
  {
    id: "exp-1",
    role: "Responsable de Alcorce Ciberseguridad",
    company: "Alcorce Telecomunicaciones",
    summary: "Fundación de la unidad de negocio, gestión de P&L y estrategia de escalado.",
    details: `Liderazgo integral en la creación de la marca 'Alcorce Ciberseguridad' desde una etapa 'Zero-to-One', asumiendo la responsabilidad total sobre la cuenta de resultados (P&L), operaciones y estrategia Go-to-Market.

    Logros e Impacto:
    - Escalado de Negocio: Crecimiento de facturación del +200% (2024) y del +600% (2025) tras el lanzamiento inicial en 2023.
    - Ecosistema: Cierre de alianzas estratégicas con fabricantes y mayoristas clave para la distribución tecnológica.

    Responsabilidades Clave:
    - Dirección Estratégica: Definición de la hoja de ruta comercial y objetivos financieros.
    - Ingeniería de Producto: "Servitización" del portfolio y diseño de soluciones de seguridad gestionada.
    - Gestión Operativa: Supervisión financiera y coordinación de equipos técnicos para el aseguramiento del servicio.`,
    year: "2022 — Actualidad"
},
  {
  id: "exp-2",
  role: "Consultor de Ciberseguridad",
  company: "Babel",
  summary: "Dirección de operaciones SOC y consultoría estratégica GRC para sector financiero.",
  details: `Gestión dual enfocada en la eficacia operativa de seguridad (SecOps) y el cumplimiento normativo en entornos de alta regulación (Banca y Seguros).

  Responsabilidades Clave:
  - Liderazgo SOC: Supervisión operativa del Centro de Operaciones de Seguridad, garantizando el cumplimiento de SLAs y la respuesta efectiva ante incidentes.
  - Consultoría GRC: Dirección de proyectos de adecuación normativa y gestión de riesgos (GDPR, ISO 27001), alineando los requisitos legales con la estrategia tecnológica.
  - Gestión de Clientes: Interlocución técnica y ejecutiva con grandes cuentas del sector financiero.`,
  year: "2021 — 2022"
},
  {
  id: "exp-3",
  role: "Responsable Unidad de Negocio Telco",
  company: "ALTEN Spain",
  summary: "Gestión de P&L, liderazgo de equipos (+35 ing.) y desarrollo de negocio (2.5M€).",
  details: `Dirección de la unidad de ingeniería prestando servicio a los principales Operadores y Fabricantes (Tier-1). Gestión integral del ciclo de vida: desde la prospección comercial y estrategia hasta la entrega del servicio.

  Logros e Impacto:
  - Volumen de Negocio: Consolidación de una cartera anual de 2,5 Millones de Euros.
  - Hipercrecimiento: Aumento de facturación del +170% (2019) y expansión acelerada de cuota de mercado en 2020.
  - Proyectos Críticos: Supervisión técnica en despliegues 5G, optimización de redes móviles y diseño de módulos para satélites de comunicaciones.

  Responsabilidades Clave:
  - Gestión Financiera: Responsable total del P&L de la unidad, márgenes y rentabilidad de proyectos.
  - Liderazgo de Equipos: Gestión, desarrollo y retención de un equipo de +35 ingenieros cualificados.
  - Estrategia Comercial: Apertura de nuevas cuentas, definición de portfolio y negociación de contratos marco.`,
  year: "2018 — 2021"
},
{
  id: "exp-4",
  role: "Consultor de Comunicaciones Unificadas",
  company: "Fibratel",
  summary: "Transformación digital y diseño de arquitecturas de colaboración para +50 clientes.",
  details: `Consultoría tecnológica orientada a la eficiencia operativa y omnicanalidad. Lideré la migración y modernización de infraestructuras para más de 50 clientes corporativos, integrando soluciones de Comunicaciones Unificadas con sistemas de gestión (ERP).

  Responsabilidades:
  - Venta Consultiva: Gestión técnica de oportunidades, ejecución de demos, workshops y diseño de soluciones a medida.
  - Ecosistema: Relación directa con fabricantes para el diseño de arquitecturas complejas.`,
  year: "2016 — 2018"
},
{
  id: "exp-5",
  role: "Ingeniero Preventa",
  company: "British Telecom (BT)",
  summary: "Diseño de arquitecturas críticas y transformación digital para cuentas IBEX35.",
  details: `Ingeniería de soluciones complejas para grandes corporaciones, con foco en redes globales, seguridad y cloud. Participación clave en proyectos de alto impacto: evolución de la red internacional para el principal banco de España, migraciones Cloud en el sector seguros y diseño de infraestructura IT global para cadenas hoteleras.

  Responsabilidades:
  - Arquitectura de Soluciones: Diseño técnico de redes corporativas (WAN/LAN), DRP, Seguridad Perimetral y Comunicaciones Unificadas (ToIP).
  - Cloud & IT: Propuestas de servicios gestionados en entornos híbridos y públicos (Azure, AWS, O365).
  - Soporte a Ventas: Elaboración de RFPs, defensa técnica de propuestas y consultoría para clientes estratégicos.`,
  year: "2015 — 2016"
}
];

const certifications = [
  {
    name: "PSAT Professional",
    issuer: "Proofpoint",
    year: "2025"
  },
  {
    name: "Certified in Cybersecurity (CC)",
    issuer: "ISC2",
    year: "2023"
  },
  {
    name: "Introduction to Cybersecurity",
    issuer: "Cisco",
    year: "2023",
    url: "https://www.credly.com/badges/667f4ff9-90d9-40ba-af09-81dcc74a1b52/public_url"
  },
  {
    name: "PACSP (Professional Accredited Cloud Security)",
    issuer: "Proofpoint",
    year: "2023",
    url: "https://verify.skilljar.com/c/o2ttw37rx69w"
  },
  {
    name: "Certified Fundamentals Cybersecurity",
    issuer: "Fortinet",
    year: "2023",
    url: "https://www.credly.com/badges/c943348d-6604-490c-8e0a-931684c5ac1f/public_url"
  },
  {
    name: "NSE 1 & NSE 2 Network Security Associate",
    issuer: "Fortinet",
    year: "2022"
  },
  {
    name: "Security Architecture for Systems Engineer #500-651",
    issuer: "Cisco",
    year: "2018"
  },
  {
    name: "CCDA - Certified Design Associate",
    issuer: "Cisco",
    year: "2017"
  },
  {
    name: "CCNA - Routing & Switching",
    issuer: "Cisco",
    year: "2015"
  }
];

// 3. LÓGICA DEL BLOG (Aquí es donde se define latestPosts)
let latestPosts = [];
try {
  const allPosts = await getCollection('blog');
  // Ordenamos por fecha y cogemos los 2 últimos
  latestPosts = allPosts
    .sort((a, b) => b.data.pubDate.valueOf() - a.data.pubDate.valueOf())
    .slice(0, 2);
} catch (e) {
  console.log("No se encontraron posts o la colección 'blog' no existe aún.");
}
---

<Layout title="Enrique Relucio - Consultor de Ciberseguridad - CV y Portfolio" showHeader={false}>
	
		
		<header class="flex flex-col gap-6">
			<div class="flex items-start gap-6">
				
				<div class="shrink-0 h-25 w-25 bg-zinc-100 dark:bg-zinc-800 rounded-2xl overflow-hidden border border-zinc-200 dark:border-zinc-700 shadow-sm relative group">
    {/* Logo Modo Claro */}
    <img 
        src="Logo_ER_B&W.png" 
        alt="Enrique Relucio" 
        class="object-cover w-full h-full opacity-90 group-hover:opacity-100 transition-opacity dark:hidden" 
    />
    {/* Logo Modo Oscuro */}
    <img 
        src="Logo_ER_White.png" 
        alt="Enrique Relucio" 
        class="hidden dark:block object-cover w-full h-full opacity-90 group-hover:opacity-100 transition-opacity" 
    />
</div>

				<div class="flex flex-col gap-2"> <h1 class="text-3xl font-medium tracking-tight text-zinc-900 dark:text-zinc-50 sm:text-4xl">
						Enrique Relucio
					</h1>
					<p class="text-[16px] leading-relaxed text-zinc-600 dark:text-zinc-400">
            <span class="text-zinc-900 dark:text-zinc-100 font-medium">Ingeniería. Estrategia. Rentabilidad.</span> Ingeniero de Telecomunicación especializado en escalar negocios de Ciberseguridad.
          </p>
				</div>
			
			</div>

            <nav class="flex gap-4">
                <a href="/blog" class="text-sm font-medium text-zinc-500 hover:text-orange-600 dark:hover:text-orange-400 transition-colors">Blog</a>
                <a href="/#proyectos" class="text-sm font-medium text-zinc-500 hover:text-orange-600 dark:hover:text-orange-400 transition-colors">
                  Proyectos
                </a>
                <a href="/#experiencia" class="text-sm font-medium text-zinc-500 hover:text-orange-600 dark:hover:text-orange-400 transition-colors">
                  Experiencia
                </a>
                <a href="/sobre-mi" class="text-sm font-medium text-zinc-500 hover:text-orange-600 dark:hover:text-orange-400 transition-colors">
                  Sobre mi
                </a>
                <a href="/contacto" class="text-sm font-medium text-zinc-500 hover:text-orange-600 dark:hover:text-orange-400 transition-colors">Contacto</a>
            </nav>
		</header>

    

    <Section title="Newsletter Diaria">
        <Newsletter />
    </Section>

        {latestPosts.length > 0 && (
            <Section title="Blog - Artículos Recientes">
                <div class="flex flex-col">
                    {latestPosts.map((post) => (
                        <BlogRow 
                          title={post.data.title}
                          date={post.data.pubDate}
                          url={`/blog/${post.slug}/`}
                          category={post.data.category} 
                          tags={post.data.tags}  
                          image={post.data.heroImage}
                        />
                    ))}
                </div>
            </Section>
        )}

		<Section title="Proyectos" id="proyectos">
    
    <div class="flex gap-2 mb-8 overflow-x-auto pb-2">
        <button 
            class="filter-btn px-4 py-1.5 rounded-full text-sm font-medium transition-all bg-zinc-900 text-white dark:bg-zinc-100 dark:text-zinc-900" 
            data-filter="todos"
        >
            Todos
        </button>
        <button 
            class="filter-btn px-4 py-1.5 rounded-full text-sm font-medium transition-all bg-zinc-100 text-zinc-600 hover:bg-zinc-200 dark:bg-zinc-800 dark:text-zinc-400 dark:hover:bg-zinc-700" 
            data-filter="consultoria"
        >
            Consultoría
        </button>
        <button 
            class="filter-btn px-4 py-1.5 rounded-full text-sm font-medium transition-all bg-zinc-100 text-zinc-600 hover:bg-zinc-200 dark:bg-zinc-800 dark:text-zinc-400 dark:hover:bg-zinc-700" 
            data-filter="desarrollo"
        >
            Desarrollo
        </button>
    </div>

    <div class="flex flex-col gap-0"> {projects.map((project) => (
            /* Envolvemos el componente en un div con el atributo data-category */
            <div class="project-item transition-all duration-300" data-category={project.category}>
                <ExpandableItem 
                    id={project.id}
                    title={project.title}
                    subtitle={`Cliente: ${project.client}`}
                    summary={project.summary}
                    details={project.details}
                    year={project.year}
                />
            </div>
        ))}
    </div>

</Section>

        <Section title="Trayectoria" id="experiencia">
      <div class="flex flex-col">
        {experience.map((job) => (
          <ExpandableItem 
            id={job.id}
            title={job.role}
            subtitle={job.company}
            summary={job.summary}
            details={job.details}
            year={job.year}
          />
        ))}
      </div>
    </Section>

        <Section title="Certificaciones">
            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                {certifications.map((cert) => (
                    <a 
                        href={cert.url} 
                        target="_blank"
                        class="flex flex-col gap-1 p-3 -mx-3 rounded-lg hover:bg-zinc-50 dark:hover:bg-zinc-900 transition-colors border border-transparent hover:border-zinc-200 dark:hover:border-zinc-800 group"
                    >
                        <div class="flex justify-between items-start w-full">
                            <h3 class="font-medium text-zinc-900 dark:text-zinc-100 text-sm group-hover:text-orange-600 dark:group-hover:text-orange-400 transition-colors">
                                {cert.name}
                            </h3>
                            <span class="text-zinc-400 text-xs font-mono tabular-nums shrink-0 ml-2">
                                {cert.year}
                            </span>
                        </div>
                        <span class="text-xs text-zinc-500 dark:text-zinc-500">
                            Emitido por <span class="text-zinc-700 dark:text-zinc-300 font-medium">{cert.issuer}</span>
                        </span>
                    </a>
                ))}
            </div>
        </Section>

	
</Layout>

<script>
    // Esperamos a que el DOM esté listo
    document.addEventListener('DOMContentLoaded', () => {
        const buttons = document.querySelectorAll('.filter-btn');
        const items = document.querySelectorAll('.project-item');

        buttons.forEach(btn => {
            btn.addEventListener('click', () => {
                // 1. Gestionar estilos de los botones (Activo/Inactivo)
                buttons.forEach(b => {
                    // Quitamos estilo activo (negro/blanco) y ponemos estilo inactivo (gris)
                    b.classList.remove('bg-zinc-900', 'text-white', 'dark:bg-zinc-100', 'dark:text-zinc-900');
                    b.classList.add('bg-zinc-100', 'text-zinc-600', 'dark:bg-zinc-800', 'dark:text-zinc-400');
                });
                
                // Ponemos estilo activo al botón pulsado
                btn.classList.remove('bg-zinc-100', 'text-zinc-600', 'dark:bg-zinc-800', 'dark:text-zinc-400');
                btn.classList.add('bg-zinc-900', 'text-white', 'dark:bg-zinc-100', 'dark:text-zinc-900');

                // 2. Filtrar los elementos
                const filterValue = btn.getAttribute('data-filter');

                items.forEach((item) => {
                    const itemCategory = item.getAttribute('data-category');
                    
                    // Si es 'todos' o coincide la categoría, mostramos. Si no, ocultamos.
                    if (filterValue === 'todos' || itemCategory === filterValue) {
                        (item as HTMLElement).style.display = 'block';
                        // Pequeño timeout para animación de opacidad si quisieras
                        setTimeout(() => (item as HTMLElement).style.opacity = '1', 10);
                    } else {
                        (item as HTMLElement).style.display = 'none';
                        (item as HTMLElement).style.opacity = '0';
                    }
                });
            });
        });
    });
</script>